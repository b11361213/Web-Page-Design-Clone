<!DOCTYPE html>
<html translate="no" lang=zh-Hans-TW >
    <head>
        <link rel="icon" type="image/gif" href="image/konata.gif">
        <link rel="stylesheet" type="text/css" href="i18n-items.css" />
        <link rel="stylesheet" type="text/css" href="i18n.css" />
        <link rel="stylesheet" type="text/css" href="main.css" />
        <meta charset="UTF-8">
        <meta name="google" content="notranslate">
        <script src="scripts\jquery.js"></script>
        <title>localhost/form.html</title>
        <style>
            [langSelect] span {
                background-color: gainsboro;
                border-radius: 3px;
                border: solid 1px;
                cursor: pointer;
                font-family: NotoSefif;
                padding: 3px;
            }
            [title] {
                margin-right: 26px;
            }
            [content] {
                /* flex-grow: 1; */
                cursor: pointer;
                display: flex;
                padding-right: 50px;
            }
            [class=langSelect] {
                font-family: NotoSefif;
                font-size: 16px;
            }
            [class=title] {
                font-family: NotoSefif;
                font-size: 36px;
                text-align: center;
                margin-top: 28px;
                margin-bottom: 28px;
}
            [class=date] {
                font-family: NotoSefif;
                font-size: 18px;
                text-align: left;
                margin-bottom: 14px;
            }
            [class=content] {
                font-family: NotoSefif;
                font-size: 22px;
                text-align: left;
                margin-bottom: 8px;
                margin-top: 10px;
            }
            [class=subcontent] {
                font-family: NotoSefif;
                font-size: 22px;
                text-align: left;
                text-indent: 180px;
            }
            [class=subForm] {
                /* background-color: azure; */
                border: solid 1px;
                font-family: NotoSefif;
                font-size: 22px;
                margin-bottom: 8px;
                margin-left: 180px;
                margin-right: 180px;
                margin-top: 8px;
                padding-bottom: 12px;
                padding-left: 32px;
                padding-top: 12px;
                text-align: left;
            }
            #memo {
                /* position:absolute; */
                /* right: 12px; */
                bottom: 4px;
                font-size: 14px;
            }
            #checkboxOption {
                margin-left: 24px;
            }
            flexrow {
                display: flex;
                flex-direction: row;
            }
            fillTen {
                flex-grow: 10;
            }
            fillOne {
                flex-grow: 1;
            }
            block {
                text-indent: 120px;
                /* margin-left: 120px; */
            }
            levelTwoBlock {
                text-indent: 240px;
                /* margin-left: 120px; */
            }
        </style>
        <!-- [source](https://gazette.nat.gov.tw/EG_FileManager/eguploadpub/eg026150/ch04/type3/gov30/num13/images/Eg01.pdf) -->
        <!-- [source](https://www.etax.nat.gov.tw/etwmain/api/functions/etw212w/download/18a49929f0e00000c88d77d84d4a57bf/%E7%A9%BA%E7%99%BD%E6%9B%B8%E8%A1%A8(pdf%E4%B8%AD%E8%8B%B1%E4%B8%A6%E5%88%97).pdf) -->
        <!-- [災害損失減免使用牌照稅申請書](https://www.etax.nat.gov.tw/etwmain/etw212w/detail/18ad49bbcb20000031d7f1e06ad74269) -->
        <!-- [download source](https://www.etax.nat.gov.tw/etwmain/etw212w) -->
        <!-- [i18n Google sheets](https://docs.google.com/spreadsheets/d/1sp-Rw0xcjd-nEMIacbVywY5zIlCbBGr-Ja9EF0DgJfg) -->
    </head>
    <body language="Chinese">
        <span class=langSelect>Language select --</span>
        <span class=langSelect langSelect>
            <span onclick="langChange(this);">Chinese</span>
            <span onclick="langChange(this);">English</span>
        </span>
        
        <!-- title -->
        <div class=title i18n=header></div>

        <!-- date -->
        <flexrow>
            <fillTen></fillTen>
            <div class=date i18n=dateOfApplication>2023/09/22</div>
            <fillOne></fillOne>
        </flexrow>
        
        <!-- content -->
        <block>
            <div class=content i18n=recipient>
                <span class=content i18n=ministryOfFinance></span>
            </div>
            
            <div class=content i18n=purpose>
                <span class=content i18n=toApplyFor></span>
            </div>
                <!-- <span select=true i18n=firstTime></span> -->

            <div class=content i18n=description></div>
            <div class=subcontent i18n=descriptionA></div>
            <div class=subcontent i18n=descriptionB></div>
        </block>
            
        <levelTwoBlock>
            <div class=subcontent i18n=descriptionBA></div>
            <div class=subcontent i18n=descriptionBB></div>
            <div class=subcontent i18n=descriptionBC></div>
            <div class=subcontent i18n=descriptionBD></div>
            <div class=subcontent i18n=descriptionBE></div>
            <div class=subcontent i18n=descriptionBF></div>
            <div class=subcontent i18n=descriptionBG></div>
            <div class=subcontent i18n=descriptionBH></div>
            <div class=subcontent i18n=descriptionBI></div>
        </levelTwoBlock>
        
        <block>
            <div class=subcontent i18n=descriptionC></div>
            <div class=subcontent i18n=descriptionCA></div>
            <div class=subcontent i18n=descriptionCB></div>
        </block>
        <block>
            <div class=content i18n=information></div>
        </block>

        <!-- information form -->
        <div class=subForm>
            <flexrow information>
                <!-- <span i18n=name></span>
                <span content></span>
                <span i18n=identityCardNumber></span>
                <span content></span> -->
            </flexrow>
        </div>
        
        <!-- contact form -->
        <div class=subForm>
            <flexrow contact></flexrow>
        </div>
        
        <!-- residence -->
        <div class=subForm i18n=residence>
            <flexrow style="flex-wrap: wrap;" residence></flexrow>
        </div>
        
        <!-- address form -->
        <div class=subForm>
            <flexrow address></flexrow>
        </div>

        <!-- footer memo -->
        <div id=memo>推薦使用 Firefox 瀏覽器瀏覽本網頁，以獲得最佳體驗</div>

        <script>          
            function langChange(obj) {
                let str = $(obj).text();
                // console.log(str);
                $("body").attr("language", str);
            }       
            $.fn.OnClick = function(fun) {
                let o = this;
                $(o).css('cursor', 'pointer');
                $(o).on('click', fun);
                return this;
            }
            function csvConvert(str) {
                return str.split(",").map(x=>x.trim()).filter(x=>x);
            }
            function applyForSel(obj) {
                let items = csvConvert(`firstTime, certificateHasCeased, lost, replacement, englishVersion`);
                // let items = ["firstTime", "certificateHasCeased", "lost", "replacement", "englishVersion"];

                for (let item of items) {
                    $(`<div class=subcontent select=false i18n=${item}></div>`).appendTo(obj).OnClick(function(e) {
                        let u = e.currentTarget;
                        let select = $(u).attr('select');
                        if (select == 'false') {
                            select = 'true';
                            $(u).siblings().attr('select', 'false');
                        }
                        else {
                            select = 'false';
                        }
                        $(u).attr('select', select);
                    });
                }
            }
            function residenceSel(obj) {
                let citiesAndCounties = csvConvert(`
                    taipeiCity, keelungCity, newTaipeiCity, lienchiangCounty, 
                    yilanCounty, hsinchuCity, hsinchuCounty, taoyuanCity, 
                    miaoliCounty, taichungCity, changhuaCounty, nantouCounty, 
                    chiayiCity, chiayiCounty, yunlinCounty, tainanCity, 
                    kaohsiungCity, penghuCounty, kinmenCounty, pingtungCounty, 
                    taitungCounty, hualienCounty
                    `);

                for (let cityAndCounty of citiesAndCounties) {
                    $(`<span style=white-space: nowrap select=false i18n=${cityAndCounty} id=checkboxOption></div>`).appendTo(obj).OnClick(function(e) {
                        let u = e.currentTarget;
                        let select = $(u).attr('select');
                        if (select == 'false') {
                            select = 'true';
                            $(u).siblings().attr('select', 'false');
                        }
                        else {
                            select = 'false';
                        }
                        $(u).attr('select', select);
                    });
                };
            }
            function fillOut(obj, tag) {
                $.fn.fillIn = function(title) {
                    let obj = this;
                    let value = 5050;
                    $(`
                    <span i18n=${title} title></span>
                    `).appendTo(obj);
                    $(`
                    <span content>${value}</span>
                    `).appendTo(obj).OnClick((e)=>{
                        let u = $(e.currentTarget);
                        let old = u.html(); u.html("");
                        let tbox = $("<textarea rows=1 cols=12>").html(old).appendTo(u).OnClick((e)=>{
                                let o = $(e.currentTarget);
                                e.stopPropagation();
                            }).on("blur", e=>{
                                let tbox = e.currentTarget;
                                $(u).html($(tbox).val());
                            });

                            tbox.get(0).setSelectionRange(old.length, old.length);
                            tbox.trigger('focus');
                        });
                        return this;
                    }
                    
                    if (tag == "info") {
                    obj.fillIn("applicant").append("<fillOne>").fillIn("identityCardNumber").append("<fillOne>");
                    }
                    if (tag == "contact") {
                        obj.fillIn("contactNumber").append("<fillOne>").fillIn("phoneNumber").append("<fillOne>");
                    }
                    if (tag == "address") {
                        obj.fillIn("address").append("<fillOne>");
                    }
                }

            applyForSel($("[i18n=purpose]"));
            residenceSel($("[residence]"));

            fillOut($("[information]"), "info");
            fillOut($("[contact]"), "contact");
            fillOut($("[address]"), "address");
        </script>
    </body>
</html>
